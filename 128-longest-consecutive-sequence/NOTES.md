Very good question on unoin find algorithm
â€‹
Basically, establish some parental relationship and use union find (fast find) for O(n) operations.